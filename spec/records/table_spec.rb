require "processors/congressional_record"

describe Processors::CongressionalRecord::Page do
  describe ".pull_tables" do
    it "preserves tables found in the record" do
      source = File.read(File.dirname(__FILE__) + "/../examples/crec-2020-10-01-p184.txt")
      page = Processors::CongressionalRecord.new(source).pages[0]
  
      parsed = page.pull_tables
      expect(parsed).to eq({
        0 => <<-GRID.rstrip,



                                                                                                                                                                                                                                          The ap-    The ap-

                                                                                                                                                                                                                                          plicable    plicable

                                                                                                                        ``If the calendar year is:                                                                                        minimum    maximum

                                                                                                                                                                                                                                          percent-   percent-

                                                                                                                                                                                                                                           age is:     age is:



                                              Any year in the period starting in 2012 and ending in 2019 ....................................................................................................                                 90%       110%

                                              Any year in the period starting in 2020 and ending in 2025 ....................................................................................................                                 95%       105%

                                              2026 ....................................................................................................................................................................................       90%       110%

                                              2027 ....................................................................................................................................................................................       85%       115%

                                              2028 ....................................................................................................................................................................................       80%       120%

                                              2029 ....................................................................................................................................................................................       75%       125%

                                              After 2029 ...........................................................................................................................................................................          70%      130%.''.
        GRID
        1 => <<-GRID.rstrip,



                                                                                                                                                                                                                                          The ap-    The ap-

                                                                                                                                                                                                                                          plicable    plicable

                                                                                                                        ``If the calendar year is:                                                                                        minimum    maximum

                                                                                                                                                                                                                                          percent-   percent-

                                                                                                                                                                                                                                           age is:     age is:



                                              Any year in the period starting in 2012 and ending in 2019 ....................................................................................................                                 90%       110%

                                              Any year in the period starting in 2020 and ending in 2025 ....................................................................................................                                 95%       105%

                                              2026 ....................................................................................................................................................................................       90%       110%

                                              2027 ....................................................................................................................................................................................       85%       115%

                                              2028 ....................................................................................................................................................................................       80%       120%

                                              2029 ....................................................................................................................................................................................       75%       125%

                                              After 2029 ...........................................................................................................................................................................          70%      130%.''.
GRID
      })
    end
  end
end
